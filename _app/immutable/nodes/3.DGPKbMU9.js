import{x as B,s as ve,n as G,b as x,r as Ke,o as We}from"../chunks/scheduler.aZHIKDCl.js";import{S as be,i as me,e as k,s as T,c as g,d as C,h as $,g as d,n as v,j as z,k as p,o as D,A as ee,r as te,p as se,b as ie,f as re,l as He,m as Q,B as Z,C as pe,w as Ne,x as Se,y as Te,t as $e,a as Ae,z as ze}from"../chunks/index.Cfc2DBzb.js";import{w as P}from"../chunks/index.Haq8omwQ.js";function H(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}const A=21,Re=Array(A).fill().map(()=>Array(A).fill(null)),Xe=Array(A).fill().map(()=>Array(A).fill().map(()=>[])),q=P(Re),le=P("alternate"),I=P("black"),X=P(Xe),R=P(0),J=P([]),ne=P([]),ke=P(!0),Ye=P([]);function Be(n,e){q.update(t=>{if(t[n][e]===null){t[n][e]=B(I),R.update(o=>o+1),X.update(o=>(o[n][e].push(B(R)),o));const l=Je(n,e,t);J.update(o=>[...o,{x:n,y:e,stone:B(I),capturedStones:l,moveCount:B(R)}]),ne.set([]),B(le)==="alternate"&&I.set(B(I)==="black"?"white":"black")}else t[n][e]=null,X.update(l=>(l[n][e].pop(),l));return t})}function Ge(){if(B(J).length>0){const n=B(J).pop();ne.update(o=>[...o,n]);const{x:e,y:t,capturedStones:l}=n;q.update(o=>(o[e][t]=null,X.update(s=>(s[e][t].pop(),s)),l.forEach(({x:s,y:r,stone:c})=>{o[s][r]=c}),o)),I.set(n.stone),R.update(o=>o-1)}}function Qe(){if(B(ne).length>0){const n=B(ne).pop(),{x:e,y:t,stone:l,moveCount:o}=n;q.update(s=>{s[e][t]=l,X.update(c=>(c[e][t].push(o),c));const r=Je(e,t,s);return J.update(c=>[...c,{x:e,y:t,stone:l,capturedStones:r,moveCount:o}]),s}),I.set(l==="black"?"white":"black"),R.update(s=>s+1)}}function Je(n,e,t){const l=B(I)==="black"?"white":"black",o=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}],s=[];for(let{dx:r,dy:c}of o){const _=n+r,f=e+c;if(_>0&&_<A&&f>0&&f<A&&t[_][f]===l){const b=Ze(_,f,l,t);xe(b,t)&&(s.push(...b),et(b,t))}}return s}function Ze(n,e,t,l,o=new Set){const s=[],r=[{x:n,y:e}];o.add(`${n},${e}`);const c=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];for(;r.length>0;){const{x:_,y:f}=r.pop();s.push({x:_,y:f,stone:l[_][f]});for(let{dx:b,dy:u}of c){const i=_+b,a=f+u;i>0&&i<A&&a>0&&a<A&&l[i][a]===t&&!o.has(`${i},${a}`)&&(o.add(`${i},${a}`),r.push({x:i,y:a}))}}return s}function xe(n,e){const t=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];for(let{x:l,y:o}of n)for(let{dx:s,dy:r}of t){const c=l+s,_=o+r;if(!(l===1&&s===-1)&&!(l===A-2&&s===1)&&!(o===1&&r===-1)&&!(o===A-2&&r===1)&&(c<=0||c>=A||_<=0||_>=A||e[c][_]===null))return!1}return!0}function et(n,e){n.forEach(({x:t,y:l})=>{e[t][l]=null})}function tt(){q.set(Array(A).fill().map(()=>Array(A).fill(null))),X.set(Array(A).fill().map(()=>Array(A).fill().map(()=>[]))),R.set(0),J.set([]),ne.set([]),I.set("black")}function nt(){ke.update(n=>!n)}function lt(){le.set("white"),I.set("white")}function ot(){le.set("black"),I.set("black")}function st(){le.set("alternate"),I.set("black")}function it(){const n=prompt("파일 이름을 입력하세요:","kibo.json");if(!n)return;const e={board:B(q),history:B(J),moveHistoryStack:B(X),moveCount:B(R)},t=JSON.stringify(e),l=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(l),s=document.createElement("a");s.href=o,s.download=n,s.click(),URL.revokeObjectURL(o)}function rt(n){const e=n.target.files[0];if(!e)return;const t=new FileReader;t.onload=l=>{const o=JSON.parse(l.target.result);qe(o)},t.readAsText(e)}function qe(n){q.set(n.board||Re),J.set(n.history||[]),X.set(n.moveHistoryStack||Xe),R.set(n.moveCount||0)}async function at(){try{const n=await fetch("/kibo/files.json");Ye.set(await n.json())}catch(n){console.error("Error fetching kibo files:",n)}}async function ct(n){const e=n.target.value;if(console.log("loadKiboFromAssets file=",e),e)try{const l=await(await fetch(`/kibo/${e}`)).json();qe(l)}catch(t){console.error("Error loading kibo file:",t)}}function De(n,e,t){const l=n.slice();return l[8]=e[t],l[10]=t,l}function Oe(n,e,t){const l=n.slice();return l[11]=e[t],l[13]=t,l}function ut(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function ft(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function ht(n){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0,style:!0}),C(e).forEach(d),this.h()},h(){v(e,"class","line horizontal svelte-v10rnh"),te(e,"top",n[16]*(1200/18)+"px")},m(t,l){z(t,e,l)},p:G,d(t){t&&d(e)}}}function dt(n){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0,style:!0}),C(e).forEach(d),this.h()},h(){v(e,"class","line vertical svelte-v10rnh"),te(e,"left",n[16]*(1200/18)+"px")},m(t,l){z(t,e,l)},p:G,d(t){t&&d(e)}}}function Me(n){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),C(e).forEach(d),this.h()},h(){v(e,"class","star-point svelte-v10rnh")},m(t,l){z(t,e,l)},d(t){t&&d(e)}}}function _t(n){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),C(e).forEach(d),this.h()},h(){v(e,"class","stone white svelte-v10rnh")},m(t,l){z(t,e,l)},d(t){t&&d(e)}}}function pt(n){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),C(e).forEach(d),this.h()},h(){v(e,"class","stone black svelte-v10rnh")},m(t,l){z(t,e,l)},d(t){t&&d(e)}}}function Ie(n){let e,t,l=n[2]&&Ue(n);return{c(){e=k("div"),l&&l.c(),this.h()},l(o){e=g(o,"DIV",{class:!0});var s=C(e);l&&l.l(s),s.forEach(d),this.h()},h(){v(e,"class",t="stone "+n[1][n[10]+1][n[13]+1]+" svelte-v10rnh")},m(o,s){z(o,e,s),l&&l.m(e,null)},p(o,s){o[2]?l?l.p(o,s):(l=Ue(o),l.c(),l.m(e,null)):l&&(l.d(1),l=null),s&2&&t!==(t="stone "+o[1][o[10]+1][o[13]+1]+" svelte-v10rnh")&&v(e,"class",t)},d(o){o&&d(e),l&&l.d()}}}function Ue(n){let e,t=n[3][n[10]+1][n[13]+1].length>0&&Ve(n);return{c(){t&&t.c(),e=se()},l(l){t&&t.l(l),e=se()},m(l,o){t&&t.m(l,o),z(l,e,o)},p(l,o){l[3][l[10]+1][l[13]+1].length>0?t?t.p(l,o):(t=Ve(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&d(e),t&&t.d(l)}}}function Ve(n){let e,t=n[3][n[10]+1][n[13]+1][n[3][n[10]+1][n[13]+1].length-1]+"",l;return{c(){e=k("span"),l=ie(t),this.h()},l(o){e=g(o,"SPAN",{class:!0});var s=C(e);l=re(s,t),s.forEach(d),this.h()},h(){v(e,"class","move-number svelte-v10rnh")},m(o,s){z(o,e,s),p(e,l)},p(o,s){s&8&&t!==(t=o[3][o[10]+1][o[13]+1][o[3][o[10]+1][o[13]+1].length-1]+"")&&He(l,t)},d(o){o&&d(e)}}}function je(n){let e,t=n[0].some(_),l,o,s,r,c;function _(...m){return n[5](n[10],n[13],...m)}let f=t&&Me();function b(m,S){if(m[1][m[10]+1][m[13]+1]==="black")return pt;if(m[1][m[10]+1][m[13]+1]==="white")return _t}let u=b(n),i=u&&u(n),a=(n[1][n[10]+1][n[13]+1]==="black"||n[1][n[10]+1][n[13]+1]==="white")&&Ie(n);function h(){return n[6](n[10],n[13])}function F(...m){return n[7](n[10],n[13],...m)}return{c(){e=k("div"),f&&f.c(),l=T(),i&&i.c(),o=T(),a&&a.c(),s=T(),this.h()},l(m){e=g(m,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var S=C(e);f&&f.l(S),l=$(S),i&&i.l(S),o=$(S),a&&a.l(S),s=$(S),S.forEach(d),this.h()},h(){v(e,"class","cell svelte-v10rnh"),te(e,"top",n[10]*(1200/18)-25+"px"),te(e,"left",n[13]*(1200/18)-25+"px"),v(e,"role","button"),v(e,"tabindex","0")},m(m,S){z(m,e,S),f&&f.m(e,null),p(e,l),i&&i.m(e,null),p(e,o),a&&a.m(e,null),p(e,s),r||(c=[D(e,"click",h),D(e,"keydown",F)],r=!0)},p(m,S){n=m,S&1&&(t=n[0].some(_)),t?f||(f=Me(),f.c(),f.m(e,l)):f&&(f.d(1),f=null),u!==(u=b(n))&&(i&&i.d(1),i=u&&u(n),i&&(i.c(),i.m(e,o))),n[1][n[10]+1][n[13]+1]==="black"||n[1][n[10]+1][n[13]+1]==="white"?a?a.p(n,S):(a=Ie(n),a.c(),a.m(e,s)):a&&(a.d(1),a=null)},d(m){m&&d(e),f&&f.d(),i&&i.d(),a&&a.d(),r=!1,Ke(c)}}}function Pe(n){let e,t=H(n[8].slice(1,20)),l=[];for(let o=0;o<t.length;o+=1)l[o]=je(Oe(n,t,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();e=se()},l(o){for(let s=0;s<l.length;s+=1)l[s].l(o);e=se()},m(o,s){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(o,s);z(o,e,s)},p(o,s){if(s&15){t=H(o[8].slice(1,20));let r;for(r=0;r<t.length;r+=1){const c=Oe(o,t,r);l[r]?l[r].p(c,s):(l[r]=je(c),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(o){o&&d(e),ee(l,o)}}}function vt(n){let e,t,l,o,s,r=H(Array(19)),c=[];for(let i=0;i<r.length;i+=1)c[i]=ht(ft(n,r,i));let _=H(Array(19)),f=[];for(let i=0;i<_.length;i+=1)f[i]=dt(ut(n,_,i));let b=H(n[1].slice(1,20)),u=[];for(let i=0;i<b.length;i+=1)u[i]=Pe(De(n,b,i));return{c(){e=k("div");for(let i=0;i<c.length;i+=1)c[i].c();t=T();for(let i=0;i<f.length;i+=1)f[i].c();l=T();for(let i=0;i<u.length;i+=1)u[i].c();this.h()},l(i){e=g(i,"DIV",{class:!0});var a=C(e);for(let h=0;h<c.length;h+=1)c[h].l(a);t=$(a);for(let h=0;h<f.length;h+=1)f[h].l(a);l=$(a);for(let h=0;h<u.length;h+=1)u[h].l(a);a.forEach(d),this.h()},h(){v(e,"class","board svelte-v10rnh")},m(i,a){z(i,e,a);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(e,null);p(e,t);for(let h=0;h<f.length;h+=1)f[h]&&f[h].m(e,null);p(e,l);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(e,null);o||(s=D(e,"contextmenu",n[4]),o=!0)},p(i,[a]){if(a&15){b=H(i[1].slice(1,20));let h;for(h=0;h<b.length;h+=1){const F=De(i,b,h);u[h]?u[h].p(F,a):(u[h]=Pe(F),u[h].c(),u[h].m(e,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=b.length}},i:G,o:G,d(i){i&&d(e),ee(c,i),ee(f,i),ee(u,i),o=!1,s()}}}function bt(n,e,t){let l,o,s;x(n,q,u=>t(1,l=u)),x(n,ke,u=>t(2,o=u)),x(n,X,u=>t(3,s=u));let{starPoints:r}=e;function c(u){u.preventDefault(),Ge()}const _=(u,i,a)=>a.x===u+1&&a.y===i+1,f=(u,i)=>{Be(u+1,i+1)},b=(u,i,a)=>{a.key==="Enter"&&Be(u+1,i+1)};return n.$$set=u=>{"starPoints"in u&&t(0,r=u.starPoints)},[r,l,o,s,c,_,f,b]}class mt extends be{constructor(e){super(),me(this,e,bt,vt,ve,{starPoints:0})}}function Fe(n,e,t){const l=n.slice();return l[3]=e[t],l}function kt(n){let e;return{c(){e=ie("순서보이기")},l(t){e=re(t,"순서보이기")},m(t,l){z(t,e,l)},d(t){t&&d(e)}}}function gt(n){let e;return{c(){e=ie("순서숨기기")},l(t){e=re(t,"순서숨기기")},m(t,l){z(t,e,l)},d(t){t&&d(e)}}}function Le(n){let e,t=n[3]+"",l,o;return{c(){e=k("option"),l=ie(t),this.h()},l(s){e=g(s,"OPTION",{});var r=C(e);l=re(r,t),r.forEach(d),this.h()},h(){e.__value=o=n[3],pe(e,e.__value)},m(s,r){z(s,e,r),p(e,l)},p(s,r){r&4&&t!==(t=s[3]+"")&&He(l,t),r&4&&o!==(o=s[3])&&(e.__value=o,pe(e,e.__value))},d(s){s&&d(e)}}}function yt(n){let e,t,l,o,s,r,c,_,f,b,u="리셋",i,a,h="<",F,m,S=">",ae,O,L,ge="기보 저장",ce,K,ye="기보 불러오기 (로컬)",ue,Y,fe,U,V,we="기보 선택 (assets)",he,Ee;function Ce(y,w){return y[1]?gt:kt}let oe=Ce(n),j=oe(n),W=H(n[2]),N=[];for(let y=0;y<W.length;y+=1)N[y]=Le(Fe(n,W,y));return{c(){e=k("div"),t=k("button"),l=T(),o=k("button"),s=T(),r=k("button"),c=T(),_=k("button"),j.c(),f=T(),b=k("button"),b.textContent=u,i=T(),a=k("button"),a.textContent=h,F=T(),m=k("button"),m.textContent=S,ae=T(),O=k("div"),L=k("button"),L.textContent=ge,ce=T(),K=k("label"),K.textContent=ye,ue=T(),Y=k("input"),fe=T(),U=k("select"),V=k("option"),V.textContent=we;for(let y=0;y<N.length;y+=1)N[y].c();this.h()},l(y){e=g(y,"DIV",{class:!0});var w=C(e);t=g(w,"BUTTON",{class:!0}),C(t).forEach(d),l=$(w),o=g(w,"BUTTON",{class:!0}),C(o).forEach(d),s=$(w),r=g(w,"BUTTON",{class:!0}),C(r).forEach(d),c=$(w),_=g(w,"BUTTON",{class:!0});var E=C(_);j.l(E),E.forEach(d),f=$(w),b=g(w,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),Q(b)!=="svelte-1owoptx"&&(b.textContent=u),i=$(w),a=g(w,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(a)!=="svelte-ymjy7r"&&(a.textContent=h),F=$(w),m=g(w,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(m)!=="svelte-6ju918"&&(m.textContent=S),ae=$(w),O=g(w,"DIV",{class:!0});var M=C(O);L=g(M,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(L)!=="svelte-5dzi3v"&&(L.textContent=ge),ce=$(M),K=g(M,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Q(K)!=="svelte-j9loce"&&(K.textContent=ye),ue=$(M),Y=g(M,"INPUT",{type:!0,id:!0,class:!0}),fe=$(M),U=g(M,"SELECT",{class:!0});var de=C(U);V=g(de,"OPTION",{"data-svelte-h":!0}),Q(V)!=="svelte-1tfg7ip"&&(V.textContent=we);for(let _e=0;_e<N.length;_e+=1)N[_e].l(de);de.forEach(d),M.forEach(d),w.forEach(d),this.h()},h(){v(t,"class","button white-button svelte-1azr0ti"),Z(t,"selected",n[0]==="white"),v(o,"class","button black-button svelte-1azr0ti"),Z(o,"selected",n[0]==="black"),v(r,"class","button alternate-button svelte-1azr0ti"),Z(r,"selected",n[0]==="alternate"),v(_,"class","button number-button svelte-1azr0ti"),v(b,"class","button number-button svelte-1azr0ti"),te(b,"background-color","red"),v(a,"class","icon-button svelte-1azr0ti"),v(m,"class","icon-button svelte-1azr0ti"),v(L,"class","kibo-button save svelte-1azr0ti"),v(K,"for","kibo-file"),v(K,"class","kibo-button load svelte-1azr0ti"),v(Y,"type","file"),v(Y,"id","kibo-file"),v(Y,"class","file-input svelte-1azr0ti"),V.__value="",pe(V,V.__value),v(U,"class","kibo-button load svelte-1azr0ti"),v(O,"class","kibo-container svelte-1azr0ti"),v(e,"class","controls svelte-1azr0ti")},m(y,w){z(y,e,w),p(e,t),p(e,l),p(e,o),p(e,s),p(e,r),p(e,c),p(e,_),j.m(_,null),p(e,f),p(e,b),p(e,i),p(e,a),p(e,F),p(e,m),p(e,ae),p(e,O),p(O,L),p(O,ce),p(O,K),p(O,ue),p(O,Y),p(O,fe),p(O,U),p(U,V);for(let E=0;E<N.length;E+=1)N[E]&&N[E].m(U,null);he||(Ee=[D(t,"click",lt),D(o,"click",ot),D(r,"click",st),D(_,"click",nt),D(b,"click",tt),D(a,"click",Ge),D(m,"click",Qe),D(L,"click",it),D(Y,"change",rt),D(U,"change",ct)],he=!0)},p(y,[w]){if(w&1&&Z(t,"selected",y[0]==="white"),w&1&&Z(o,"selected",y[0]==="black"),w&1&&Z(r,"selected",y[0]==="alternate"),oe!==(oe=Ce(y))&&(j.d(1),j=oe(y),j&&(j.c(),j.m(_,null))),w&4){W=H(y[2]);let E;for(E=0;E<W.length;E+=1){const M=Fe(y,W,E);N[E]?N[E].p(M,w):(N[E]=Le(M),N[E].c(),N[E].m(U,null))}for(;E<N.length;E+=1)N[E].d(1);N.length=W.length}},i:G,o:G,d(y){y&&d(e),j.d(),ee(N,y),he=!1,Ke(Ee)}}}function wt(n,e,t){let l,o,s;return x(n,le,r=>t(0,l=r)),x(n,ke,r=>t(1,o=r)),x(n,Ye,r=>t(2,s=r)),[l,o,s]}class Et extends be{constructor(e){super(),me(this,e,wt,yt,ve,{})}}const Ct=[{x:4,y:4},{x:4,y:10},{x:4,y:16},{x:10,y:4},{x:10,y:10},{x:10,y:16},{x:16,y:4},{x:16,y:10},{x:16,y:16}];function Nt(n){let e,t,l,o,s,r;return l=new mt({props:{starPoints:Ct}}),s=new Et({}),{c(){e=k("div"),t=k("div"),Ne(l.$$.fragment),o=T(),Ne(s.$$.fragment),this.h()},l(c){e=g(c,"DIV",{class:!0});var _=C(e);t=g(_,"DIV",{class:!0});var f=C(t);Se(l.$$.fragment,f),o=$(f),Se(s.$$.fragment,f),f.forEach(d),_.forEach(d),this.h()},h(){v(t,"class","board-container svelte-1opwkik"),v(e,"class","container svelte-1opwkik")},m(c,_){z(c,e,_),p(e,t),Te(l,t,null),p(t,o),Te(s,t,null),r=!0},p:G,i(c){r||($e(l.$$.fragment,c),$e(s.$$.fragment,c),r=!0)},o(c){Ae(l.$$.fragment,c),Ae(s.$$.fragment,c),r=!1},d(c){c&&d(e),ze(l),ze(s)}}}function St(n){return We(async()=>{console.log("import.meta.env.DEV = ",!1),at()}),[]}class zt extends be{constructor(e){super(),me(this,e,St,Nt,ve,{})}}export{zt as component};
