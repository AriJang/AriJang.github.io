import{x as O,s as be,n as G,b as x,r as He}from"../chunks/scheduler.aZHIKDCl.js";import{S as ve,i as me,e as k,s as T,c as g,d as E,h as $,g as h,n as b,j as A,k as p,o as B,A as ee,r as te,p as se,b as ie,f as re,l as Re,m as Q,B as Z,C as pe,w as Se,x as Ne,y as Te,t as $e,a as ze,z as Ae}from"../chunks/index.Cfc2DBzb.js";import{w as P}from"../chunks/index.Haq8omwQ.js";function R(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}const z=21,Ke=Array(z).fill().map(()=>Array(z).fill(null)),Xe=Array(z).fill().map(()=>Array(z).fill().map(()=>[])),q=P(Ke),ne=P("alternate"),M=P("black"),X=P(Xe),K=P(0),J=P([]),le=P([]),ke=P(!0),qe=P([]);function Oe(l,e){console.log("playStone x=",l," y=",e),q.update(t=>{if(console.log("b[x][y] = ",t[l][e]),t[l][e]===null){t[l][e]=O(M),K.update(o=>o+1),X.update(o=>(o[l][e].push(O(K)),o));const n=Ge(l,e,t);J.update(o=>[...o,{x:l,y:e,stone:O(M),capturedStones:n,moveCount:O(K)}]),le.set([]),O(ne)==="alternate"&&M.set(O(M)==="black"?"white":"black")}else t[l][e]=null,X.update(n=>(n[l][e].pop(),n));return t})}function Ye(){if(O(J).length>0){const l=O(J).pop();le.update(o=>[...o,l]);const{x:e,y:t,capturedStones:n}=l;q.update(o=>(o[e][t]=null,X.update(s=>(s[e][t].pop(),s)),n.forEach(({x:s,y:r,stone:c})=>{o[s][r]=c}),o)),M.set(l.stone),K.update(o=>o-1)}}function We(){if(O(le).length>0){const l=O(le).pop(),{x:e,y:t,stone:n,moveCount:o}=l;q.update(s=>{s[e][t]=n,X.update(c=>(c[e][t].push(o),c));const r=Ge(e,t,s);return J.update(c=>[...c,{x:e,y:t,stone:n,capturedStones:r,moveCount:o}]),s}),M.set(n==="black"?"white":"black"),K.update(s=>s+1)}}function Ge(l,e,t){const n=O(M)==="black"?"white":"black",o=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}],s=[];for(let{dx:r,dy:c}of o){const _=l+r,f=e+c;if(_>0&&_<z&&f>0&&f<z&&t[_][f]===n){const v=Qe(_,f,n,t);Ze(v,t)&&(s.push(...v),xe(v,t))}}return s}function Qe(l,e,t,n,o=new Set){const s=[],r=[{x:l,y:e}];o.add(`${l},${e}`);const c=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];for(;r.length>0;){const{x:_,y:f}=r.pop();s.push({x:_,y:f,stone:n[_][f]});for(let{dx:v,dy:u}of c){const i=_+v,a=f+u;i>0&&i<z&&a>0&&a<z&&n[i][a]===t&&!o.has(`${i},${a}`)&&(o.add(`${i},${a}`),r.push({x:i,y:a}))}}return s}function Ze(l,e){const t=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];for(let{x:n,y:o}of l)for(let{dx:s,dy:r}of t){const c=n+s,_=o+r;if(!(n===1&&s===-1)&&!(n===z-2&&s===1)&&!(o===1&&r===-1)&&!(o===z-2&&r===1)&&(c<=0||c>=z||_<=0||_>=z||e[c][_]===null))return!1}return!0}function xe(l,e){l.forEach(({x:t,y:n})=>{e[t][n]=null})}function et(){q.set(Array(z).fill().map(()=>Array(z).fill(null))),X.set(Array(z).fill().map(()=>Array(z).fill().map(()=>[]))),K.set(0),J.set([]),le.set([]),M.set("black")}function tt(){ke.update(l=>!l)}function lt(){ne.set("white"),M.set("white")}function nt(){ne.set("black"),M.set("black")}function ot(){ne.set("alternate"),M.set("black")}function st(){const l=prompt("파일 이름을 입력하세요:","kibo.json");if(!l)return;const e={board:O(q),history:O(J),moveHistoryStack:O(X),moveCount:O(K)},t=JSON.stringify(e),n=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download=l,s.click(),URL.revokeObjectURL(o)}function it(l){if(!l)return;const e=new FileReader;e.onload=t=>{const n=JSON.parse(t.target.result);Je(n)},e.readAsText(l)}function Je(l){q.set(l.board||Ke),J.set(l.history||[]),X.set(l.moveHistoryStack||Xe),K.set(l.moveCount||0)}async function rt(l){if(l)try{const t=await(await fetch(`/kibo/${l}`)).json();Je(t)}catch(e){console.error("Error loading kibo file:",e)}}function Be(l,e,t){const n=l.slice();return n[8]=e[t],n[10]=t,n}function De(l,e,t){const n=l.slice();return n[11]=e[t],n[13]=t,n}function at(l,e,t){const n=l.slice();return n[14]=e[t],n[16]=t,n}function ct(l,e,t){const n=l.slice();return n[14]=e[t],n[16]=t,n}function ut(l){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0,style:!0}),E(e).forEach(h),this.h()},h(){b(e,"class","line horizontal svelte-b3307"),te(e,"top",l[16]*(1200/18)+"px")},m(t,n){A(t,e,n)},p:G,d(t){t&&h(e)}}}function ft(l){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0,style:!0}),E(e).forEach(h),this.h()},h(){b(e,"class","line vertical svelte-b3307"),te(e,"left",l[16]*(1200/18)+"px")},m(t,n){A(t,e,n)},p:G,d(t){t&&h(e)}}}function Ie(l){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),E(e).forEach(h),this.h()},h(){b(e,"class","star-point svelte-b3307")},m(t,n){A(t,e,n)},d(t){t&&h(e)}}}function dt(l){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),E(e).forEach(h),this.h()},h(){b(e,"class","stone white svelte-b3307")},m(t,n){A(t,e,n)},d(t){t&&h(e)}}}function ht(l){let e;return{c(){e=k("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),E(e).forEach(h),this.h()},h(){b(e,"class","stone black svelte-b3307")},m(t,n){A(t,e,n)},d(t){t&&h(e)}}}function Me(l){let e,t,n=l[2]&&Ue(l);return{c(){e=k("div"),n&&n.c(),this.h()},l(o){e=g(o,"DIV",{class:!0});var s=E(e);n&&n.l(s),s.forEach(h),this.h()},h(){b(e,"class",t="stone "+l[1][l[10]+1][l[13]+1]+" svelte-b3307")},m(o,s){A(o,e,s),n&&n.m(e,null)},p(o,s){o[2]?n?n.p(o,s):(n=Ue(o),n.c(),n.m(e,null)):n&&(n.d(1),n=null),s&2&&t!==(t="stone "+o[1][o[10]+1][o[13]+1]+" svelte-b3307")&&b(e,"class",t)},d(o){o&&h(e),n&&n.d()}}}function Ue(l){let e,t=l[3][l[10]+1][l[13]+1].length>0&&Ve(l);return{c(){t&&t.c(),e=se()},l(n){t&&t.l(n),e=se()},m(n,o){t&&t.m(n,o),A(n,e,o)},p(n,o){n[3][n[10]+1][n[13]+1].length>0?t?t.p(n,o):(t=Ve(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&h(e),t&&t.d(n)}}}function Ve(l){let e,t=l[3][l[10]+1][l[13]+1][l[3][l[10]+1][l[13]+1].length-1]+"",n;return{c(){e=k("span"),n=ie(t),this.h()},l(o){e=g(o,"SPAN",{class:!0});var s=E(e);n=re(s,t),s.forEach(h),this.h()},h(){b(e,"class","move-number svelte-b3307")},m(o,s){A(o,e,s),p(e,n)},p(o,s){s&8&&t!==(t=o[3][o[10]+1][o[13]+1][o[3][o[10]+1][o[13]+1].length-1]+"")&&Re(n,t)},d(o){o&&h(e)}}}function je(l){let e,t=l[0].some(_),n,o,s,r,c;function _(...m){return l[5](l[10],l[13],...m)}let f=t&&Ie();function v(m,N){if(m[1][m[10]+1][m[13]+1]==="black")return ht;if(m[1][m[10]+1][m[13]+1]==="white")return dt}let u=v(l),i=u&&u(l),a=(l[1][l[10]+1][l[13]+1]==="black"||l[1][l[10]+1][l[13]+1]==="white")&&Me(l);function d(){return l[6](l[10],l[13])}function L(...m){return l[7](l[10],l[13],...m)}return{c(){e=k("div"),f&&f.c(),n=T(),i&&i.c(),o=T(),a&&a.c(),s=T(),this.h()},l(m){e=g(m,"DIV",{class:!0,style:!0,role:!0,tabindex:!0});var N=E(e);f&&f.l(N),n=$(N),i&&i.l(N),o=$(N),a&&a.l(N),s=$(N),N.forEach(h),this.h()},h(){b(e,"class","cell svelte-b3307"),te(e,"top",l[10]*(1200/18)-25+"px"),te(e,"left",l[13]*(1200/18)-25+"px"),b(e,"role","button"),b(e,"tabindex","0")},m(m,N){A(m,e,N),f&&f.m(e,null),p(e,n),i&&i.m(e,null),p(e,o),a&&a.m(e,null),p(e,s),r||(c=[B(e,"click",d),B(e,"keydown",L)],r=!0)},p(m,N){l=m,N&1&&(t=l[0].some(_)),t?f||(f=Ie(),f.c(),f.m(e,n)):f&&(f.d(1),f=null),u!==(u=v(l))&&(i&&i.d(1),i=u&&u(l),i&&(i.c(),i.m(e,o))),l[1][l[10]+1][l[13]+1]==="black"||l[1][l[10]+1][l[13]+1]==="white"?a?a.p(l,N):(a=Me(l),a.c(),a.m(e,s)):a&&(a.d(1),a=null)},d(m){m&&h(e),f&&f.d(),i&&i.d(),a&&a.d(),r=!1,He(c)}}}function Pe(l){let e,t=R(l[8].slice(1,20)),n=[];for(let o=0;o<t.length;o+=1)n[o]=je(De(l,t,o));return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=se()},l(o){for(let s=0;s<n.length;s+=1)n[s].l(o);e=se()},m(o,s){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(o,s);A(o,e,s)},p(o,s){if(s&15){t=R(o[8].slice(1,20));let r;for(r=0;r<t.length;r+=1){const c=De(o,t,r);n[r]?n[r].p(c,s):(n[r]=je(c),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(o){o&&h(e),ee(n,o)}}}function _t(l){let e,t,n,o,s,r=R(Array(19)),c=[];for(let i=0;i<r.length;i+=1)c[i]=ut(ct(l,r,i));let _=R(Array(19)),f=[];for(let i=0;i<_.length;i+=1)f[i]=ft(at(l,_,i));let v=R(l[1].slice(1,20)),u=[];for(let i=0;i<v.length;i+=1)u[i]=Pe(Be(l,v,i));return{c(){e=k("div");for(let i=0;i<c.length;i+=1)c[i].c();t=T();for(let i=0;i<f.length;i+=1)f[i].c();n=T();for(let i=0;i<u.length;i+=1)u[i].c();this.h()},l(i){e=g(i,"DIV",{class:!0});var a=E(e);for(let d=0;d<c.length;d+=1)c[d].l(a);t=$(a);for(let d=0;d<f.length;d+=1)f[d].l(a);n=$(a);for(let d=0;d<u.length;d+=1)u[d].l(a);a.forEach(h),this.h()},h(){b(e,"class","board svelte-b3307")},m(i,a){A(i,e,a);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(e,null);p(e,t);for(let d=0;d<f.length;d+=1)f[d]&&f[d].m(e,null);p(e,n);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(e,null);o||(s=B(e,"contextmenu",l[4]),o=!0)},p(i,[a]){if(a&15){v=R(i[1].slice(1,20));let d;for(d=0;d<v.length;d+=1){const L=Be(i,v,d);u[d]?u[d].p(L,a):(u[d]=Pe(L),u[d].c(),u[d].m(e,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=v.length}},i:G,o:G,d(i){i&&h(e),ee(c,i),ee(f,i),ee(u,i),o=!1,s()}}}function pt(l,e,t){let n,o,s;x(l,q,u=>t(1,n=u)),x(l,ke,u=>t(2,o=u)),x(l,X,u=>t(3,s=u));let{starPoints:r}=e;function c(u){u.preventDefault(),Ye()}const _=(u,i,a)=>a.x===u+1&&a.y===i+1,f=(u,i)=>{console.log(`Clicked at position: (${u+1}, ${i+1})`),Oe(u+1,i+1)},v=(u,i,a)=>{a.key==="Enter"&&Oe(u+1,i+1)};return l.$$set=u=>{"starPoints"in u&&t(0,r=u.starPoints)},[r,n,o,s,c,_,f,v]}class bt extends ve{constructor(e){super(),me(this,e,pt,_t,be,{starPoints:0})}}function Le(l,e,t){const n=l.slice();return n[3]=e[t],n}function vt(l){let e;return{c(){e=ie("순서보이기")},l(t){e=re(t,"순서보이기")},m(t,n){A(t,e,n)},d(t){t&&h(e)}}}function mt(l){let e;return{c(){e=ie("순서숨기기")},l(t){e=re(t,"순서숨기기")},m(t,n){A(t,e,n)},d(t){t&&h(e)}}}function Fe(l){let e,t=l[3]+"",n,o;return{c(){e=k("option"),n=ie(t),this.h()},l(s){e=g(s,"OPTION",{});var r=E(e);n=re(r,t),r.forEach(h),this.h()},h(){e.__value=o=l[3],pe(e,e.__value)},m(s,r){A(s,e,r),p(e,n)},p(s,r){r&4&&t!==(t=s[3]+"")&&Re(n,t),r&4&&o!==(o=s[3])&&(e.__value=o,pe(e,e.__value))},d(s){s&&h(e)}}}function kt(l){let e,t,n,o,s,r,c,_,f,v,u="리셋",i,a,d="<",L,m,N=">",ae,D,F,ge="기보 저장",ce,H,ye="기보 불러오기 (로컬)",ue,Y,fe,U,V,we="기보 선택 (assets)",de,Ce;function Ee(y,w){return y[1]?mt:vt}let oe=Ee(l),j=oe(l),W=R(l[2]),S=[];for(let y=0;y<W.length;y+=1)S[y]=Fe(Le(l,W,y));return{c(){e=k("div"),t=k("button"),n=T(),o=k("button"),s=T(),r=k("button"),c=T(),_=k("button"),j.c(),f=T(),v=k("button"),v.textContent=u,i=T(),a=k("button"),a.textContent=d,L=T(),m=k("button"),m.textContent=N,ae=T(),D=k("div"),F=k("button"),F.textContent=ge,ce=T(),H=k("label"),H.textContent=ye,ue=T(),Y=k("input"),fe=T(),U=k("select"),V=k("option"),V.textContent=we;for(let y=0;y<S.length;y+=1)S[y].c();this.h()},l(y){e=g(y,"DIV",{class:!0});var w=E(e);t=g(w,"BUTTON",{class:!0}),E(t).forEach(h),n=$(w),o=g(w,"BUTTON",{class:!0}),E(o).forEach(h),s=$(w),r=g(w,"BUTTON",{class:!0}),E(r).forEach(h),c=$(w),_=g(w,"BUTTON",{class:!0});var C=E(_);j.l(C),C.forEach(h),f=$(w),v=g(w,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),Q(v)!=="svelte-1owoptx"&&(v.textContent=u),i=$(w),a=g(w,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(a)!=="svelte-ymjy7r"&&(a.textContent=d),L=$(w),m=g(w,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(m)!=="svelte-6ju918"&&(m.textContent=N),ae=$(w),D=g(w,"DIV",{class:!0});var I=E(D);F=g(I,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(F)!=="svelte-5dzi3v"&&(F.textContent=ge),ce=$(I),H=g(I,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),Q(H)!=="svelte-j9loce"&&(H.textContent=ye),ue=$(I),Y=g(I,"INPUT",{type:!0,id:!0,class:!0}),fe=$(I),U=g(I,"SELECT",{class:!0});var he=E(U);V=g(he,"OPTION",{"data-svelte-h":!0}),Q(V)!=="svelte-1tfg7ip"&&(V.textContent=we);for(let _e=0;_e<S.length;_e+=1)S[_e].l(he);he.forEach(h),I.forEach(h),w.forEach(h),this.h()},h(){b(t,"class","button white-button svelte-1azr0ti"),Z(t,"selected",l[0]==="white"),b(o,"class","button black-button svelte-1azr0ti"),Z(o,"selected",l[0]==="black"),b(r,"class","button alternate-button svelte-1azr0ti"),Z(r,"selected",l[0]==="alternate"),b(_,"class","button number-button svelte-1azr0ti"),b(v,"class","button number-button svelte-1azr0ti"),te(v,"background-color","red"),b(a,"class","icon-button svelte-1azr0ti"),b(m,"class","icon-button svelte-1azr0ti"),b(F,"class","kibo-button save svelte-1azr0ti"),b(H,"for","kibo-file"),b(H,"class","kibo-button load svelte-1azr0ti"),b(Y,"type","file"),b(Y,"id","kibo-file"),b(Y,"class","file-input svelte-1azr0ti"),V.__value="",pe(V,V.__value),b(U,"class","kibo-button load svelte-1azr0ti"),b(D,"class","kibo-container svelte-1azr0ti"),b(e,"class","controls svelte-1azr0ti")},m(y,w){A(y,e,w),p(e,t),p(e,n),p(e,o),p(e,s),p(e,r),p(e,c),p(e,_),j.m(_,null),p(e,f),p(e,v),p(e,i),p(e,a),p(e,L),p(e,m),p(e,ae),p(e,D),p(D,F),p(D,ce),p(D,H),p(D,ue),p(D,Y),p(D,fe),p(D,U),p(U,V);for(let C=0;C<S.length;C+=1)S[C]&&S[C].m(U,null);de||(Ce=[B(t,"click",lt),B(o,"click",nt),B(r,"click",ot),B(_,"click",tt),B(v,"click",et),B(a,"click",Ye),B(m,"click",We),B(F,"click",st),B(Y,"change",it),B(U,"change",rt)],de=!0)},p(y,[w]){if(w&1&&Z(t,"selected",y[0]==="white"),w&1&&Z(o,"selected",y[0]==="black"),w&1&&Z(r,"selected",y[0]==="alternate"),oe!==(oe=Ee(y))&&(j.d(1),j=oe(y),j&&(j.c(),j.m(_,null))),w&4){W=R(y[2]);let C;for(C=0;C<W.length;C+=1){const I=Le(y,W,C);S[C]?S[C].p(I,w):(S[C]=Fe(I),S[C].c(),S[C].m(U,null))}for(;C<S.length;C+=1)S[C].d(1);S.length=W.length}},i:G,o:G,d(y){y&&h(e),j.d(),ee(S,y),de=!1,He(Ce)}}}function gt(l,e,t){let n,o,s;return x(l,ne,r=>t(0,n=r)),x(l,ke,r=>t(1,o=r)),x(l,qe,r=>t(2,s=r)),[n,o,s]}class yt extends ve{constructor(e){super(),me(this,e,gt,kt,be,{})}}const wt=[{x:4,y:4},{x:4,y:10},{x:4,y:16},{x:10,y:4},{x:10,y:10},{x:10,y:16},{x:16,y:4},{x:16,y:10},{x:16,y:16}];function Ct(l){let e,t,n,o,s,r;return n=new bt({props:{starPoints:wt}}),s=new yt({}),{c(){e=k("div"),t=k("div"),Se(n.$$.fragment),o=T(),Se(s.$$.fragment),this.h()},l(c){e=g(c,"DIV",{class:!0});var _=E(e);t=g(_,"DIV",{class:!0});var f=E(t);Ne(n.$$.fragment,f),o=$(f),Ne(s.$$.fragment,f),f.forEach(h),_.forEach(h),this.h()},h(){b(t,"class","board-container svelte-1opwkik"),b(e,"class","container svelte-1opwkik")},m(c,_){A(c,e,_),p(e,t),Te(n,t,null),p(t,o),Te(s,t,null),r=!0},p:G,i(c){r||($e(n.$$.fragment,c),$e(s.$$.fragment,c),r=!0)},o(c){ze(n.$$.fragment,c),ze(s.$$.fragment,c),r=!1},d(c){c&&h(e),Ae(n),Ae(s)}}}class Tt extends ve{constructor(e){super(),me(this,e,null,Ct,be,{})}}export{Tt as component};
